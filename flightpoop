-- Enhanced Noclip Flight Script with Mobile Controls
-- Based on original by @CloneTrooper1019

local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")

local Player = Players.LocalPlayer
local Camera = workspace.CurrentCamera

-- Configuration
local FlyKey = Enum.KeyCode.F
local Speed = 50
local MaxSpeed = 200
local SpeedIncrement = 10
local isFlying = false
local isEnabled = false
local MoveDirection = Vector3.new()
local CurrentSpeed = Speed

-- Detect if on mobile
local IS_MOBILE = UserInputService.TouchEnabled and not UserInputService.MouseEnabled and not UserInputService.KeyboardEnabled

-- Main GUI
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "FlightGui"
ScreenGui.Parent = Player.PlayerGui
ScreenGui.ResetOnSpawn = false

local Frame = Instance.new("Frame")
Frame.Size = UDim2.new(0, 200, 0, 80)
Frame.Position = UDim2.new(0.5, -100, 0, 10)
Frame.AnchorPoint = Vector2.new(0.5, 0)
Frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
Frame.BackgroundTransparency = 0.5
Frame.BorderSizePixel = 0
Frame.Parent = ScreenGui

local StatusLabel = Instance.new("TextLabel")
StatusLabel.Size = UDim2.new(1, 0, 0, 30)
StatusLabel.Position = UDim2.new(0, 0, 0, 0)
StatusLabel.BackgroundTransparency = 1
StatusLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
StatusLabel.Text = "Flight: Disabled "..(IS_MOBILE and "(Tap Toggle)" or "(Press F)")
StatusLabel.Font = Enum.Font.GothamBold
StatusLabel.TextSize = 16
StatusLabel.Parent = Frame

local SpeedLabel = Instance.new("TextLabel")
SpeedLabel.Size = UDim2.new(1, 0, 0, 20)
SpeedLabel.Position = UDim2.new(0, 0, 0, 35)
SpeedLabel.BackgroundTransparency = 1
SpeedLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
SpeedLabel.Text = "Speed: " .. Speed
SpeedLabel.Font = Enum.Font.Gotham
SpeedLabel.TextSize = 14
SpeedLabel.Parent = Frame

local ControlsLabel = Instance.new("TextLabel")
ControlsLabel.Size = UDim2.new(1, 0, 0, 20)
ControlsLabel.Position = UDim2.new(0, 0, 0, 55)
ControlsLabel.BackgroundTransparency = 1
ControlsLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
ControlsLabel.Text = IS_MOBILE and "Use joystick + buttons to fly" or "WASD + Space/Ctrl | Scroll to adjust speed"
ControlsLabel.Font = Enum.Font.Gotham
ControlsLabel.TextSize = 12
ControlsLabel.Parent = Frame

-- Mobile Controls GUI
local MobileGui = Instance.new("ScreenGui")
MobileGui.Name = "MobileFlightControls"
MobileGui.Parent = Player.PlayerGui
MobileGui.ResetOnSpawn = false
MobileGui.Enabled = false

-- Mobile Toggle Button
local ToggleButton = Instance.new("TextButton")
ToggleButton.Size = UDim2.new(0, 100, 0, 40)
ToggleButton.Position = UDim2.new(0.5, -50, 0.9, -40)
ToggleButton.AnchorPoint = Vector2.new(0.5, 0)
ToggleButton.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
ToggleButton.BackgroundTransparency = 0.5
ToggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
ToggleButton.Text = "Toggle Flight"
ToggleButton.Font = Enum.Font.GothamBold
ToggleButton.TextSize = 14
ToggleButton.Parent = MobileGui

-- Mobile Joystick
local JoystickFrame = Instance.new("Frame")
JoystickFrame.Size = UDim2.new(0, 120, 0, 120)
JoystickFrame.Position = UDim2.new(0, 20, 0.7, -60)
JoystickFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
JoystickFrame.BackgroundTransparency = 0.7
JoystickFrame.BorderSizePixel = 0
JoystickFrame.Visible = false
JoystickFrame.Parent = MobileGui

local JoystickInner = Instance.new("Frame")
JoystickInner.Size = UDim2.new(0, 40, 0, 40)
JoystickInner.Position = UDim2.new(0.5, -20, 0.5, -20)
JoystickInner.AnchorPoint = Vector2.new(0.5, 0.5)
JoystickInner.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
JoystickInner.BackgroundTransparency = 0.5
JoystickInner.BorderSizePixel = 0
JoystickInner.Parent = JoystickFrame

-- Mobile Action Buttons
local UpButton = Instance.new("TextButton")
UpButton.Size = UDim2.new(0, 60, 0, 60)
UpButton.Position = UDim2.new(0.8, -30, 0.7, -90)
UpButton.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
UpButton.BackgroundTransparency = 0.5
UpButton.Text = "↑"
UpButton.TextColor3 = Color3.fromRGB(255, 255, 255)
UpButton.Font = Enum.Font.GothamBold
UpButton.TextSize = 20
UpButton.Visible = false
UpButton.Parent = MobileGui

local DownButton = Instance.new("TextButton")
DownButton.Size = UDim2.new(0, 60, 0, 60)
DownButton.Position = UDim2.new(0.8, -30, 0.7, 0)
DownButton.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
DownButton.BackgroundTransparency = 0.5
DownButton.Text = "↓"
DownButton.TextColor3 = Color3.fromRGB(255, 255, 255)
DownButton.Font = Enum.Font.GothamBold
DownButton.TextSize = 20
DownButton.Visible = false
DownButton.Parent = MobileGui

local SpeedUpButton = Instance.new("TextButton")
SpeedUpButton.Size = UDim2.new(0, 60, 0, 40)
SpeedUpButton.Position = UDim2.new(0.9, -60, 0.8, -80)
SpeedUpButton.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
SpeedUpButton.BackgroundTransparency = 0.5
SpeedUpButton.Text = "Speed+"
SpeedUpButton.TextColor3 = Color3.fromRGB(255, 255, 255)
SpeedUpButton.Font = Enum.Font.Gotham
SpeedUpButton.TextSize = 12
SpeedUpButton.Visible = false
SpeedUpButton.Parent = MobileGui

local SpeedDownButton = Instance.new("TextButton")
SpeedDownButton.Size = UDim2.new(0, 60, 0, 40)
SpeedDownButton.Position = UDim2.new(0.9, -60, 0.8, -30)
SpeedDownButton.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
SpeedDownButton.BackgroundTransparency = 0.5
SpeedDownButton.Text = "Speed-"
SpeedDownButton.TextColor3 = Color3.fromRGB(255, 255, 255)
SpeedDownButton.Font = Enum.Font.Gotham
SpeedDownButton.TextSize = 12
SpeedDownButton.Visible = false
SpeedDownButton.Parent = MobileGui

-- Function to update the GUI
local function UpdateGUI()
    StatusLabel.Text = "Flight: " .. (isEnabled and "ENABLED" or "Disabled "..(IS_MOBILE and "(Tap Toggle)" or "(Press F)"))
    StatusLabel.TextColor3 = isEnabled and Color3.fromRGB(0, 255, 127) or Color3.fromRGB(255, 255, 255)
    SpeedLabel.Text = "Speed: " .. CurrentSpeed
    SpeedLabel.Visible = isEnabled
    ControlsLabel.Visible = isEnabled
    
    if IS_MOBILE then
        JoystickFrame.Visible = isEnabled
        UpButton.Visible = isEnabled
        DownButton.Visible = isEnabled
        SpeedUpButton.Visible = isEnabled
        SpeedDownButton.Visible = isEnabled
        MobileGui.Enabled = true
    end
end

-- Mobile Joystick Logic
local joystickActive = false
local joystickStartPos = Vector2.new()
local joystickCurrentPos = Vector2.new()

JoystickFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.Touch then
        joystickActive = true
        joystickStartPos = Vector2.new(input.Position.X, input.Position.Y)
    end
end)

JoystickFrame.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.Touch and joystickActive then
        joystickCurrentPos = Vector2.new(input.Position.X, input.Position.Y)
        local delta = (joystickCurrentPos - joystickStartPos) / 60
        delta = Vector2.new(math.clamp(delta.X, -1, 1), math.clamp(delta.Y, -1, 1))
        
        MoveDirection = Vector3.new(delta.X, MoveDirection.Y, delta.Y)
        
        -- Update joystick visual position
        JoystickInner.Position = UDim2.new(0.5, delta.X * 30, 0.5, delta.Y * 30)
    end
end)

JoystickFrame.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.Touch then
        joystickActive = false
        MoveDirection = Vector3.new(0, MoveDirection.Y, 0)
        JoystickInner.Position = UDim2.new(0.5, -20, 0.5, -20)
    end
end)

-- Mobile Button Actions
UpButton.MouseButton1Down:Connect(function()
    MoveDirection = Vector3.new(MoveDirection.X, 1, MoveDirection.Z)
end)

UpButton.MouseButton1Up:Connect(function()
    MoveDirection = Vector3.new(MoveDirection.X, 0, MoveDirection.Z)
end)

DownButton.MouseButton1Down:Connect(function()
    MoveDirection = Vector3.new(MoveDirection.X, -1, MoveDirection.Z)
end)

DownButton.MouseButton1Up:Connect(function()
    MoveDirection = Vector3.new(MoveDirection.X, 0, MoveDirection.Z)
end)

SpeedUpButton.MouseButton1Click:Connect(function()
    CurrentSpeed = math.clamp(CurrentSpeed + SpeedIncrement, 1, MaxSpeed)
    UpdateGUI()
end)

SpeedDownButton.MouseButton1Click:Connect(function()
    CurrentSpeed = math.clamp(CurrentSpeed - SpeedIncrement, 1, MaxSpeed)
    UpdateGUI()
end)

ToggleButton.MouseButton1Click:Connect(function()
    isEnabled = not isEnabled
    UpdateGUI()
    
    if isEnabled then
        local cleanup = FlyCharacter()
        task.spawn(function()
            while isEnabled do task.wait() end
            if cleanup then cleanup() end
        end)
    end
end)

-- Main flight function - FIXED VERSION
local function FlyCharacter()
    local Character = Player.Character
    if not Character or not isEnabled then return end

    local Humanoid = Character:FindFirstChildOfClass("Humanoid")
    local HumanoidRootPart = Character:FindFirstChild("HumanoidRootPart")
    
    if not Humanoid or not HumanoidRootPart then return end
    
    -- Store original state
    local WasAnchored = HumanoidRootPart.Anchored
    local WasPlatformStand = Humanoid.PlatformStand
    
    -- Setup for flight
    HumanoidRootPart.Anchored = true
    Humanoid.PlatformStand = true
    Humanoid.AutoRotate = false

    -- Create a new Heartbeat connection for smooth movement
    local flightConnection
    flightConnection = RunService.Heartbeat:Connect(function(deltaTime)
        -- Check if we should still be flying
        if not isEnabled or not Character or not HumanoidRootPart or HumanoidRootPart.Parent ~= Character then
            if flightConnection then
                flightConnection:Disconnect()
            end
            return
        end

        -- Calculate movement based on camera orientation (ONLY if a direction is set)
        if MoveDirection.Magnitude > 0 then
            local CameraCFrame = Camera.CFrame
            local LookVector = CameraCFrame.LookVector
            local RightVector = CameraCFrame.RightVector
            local UpVector = Vector3.new(0, 1, 0)
            
            -- Calculate final movement direction
            local Movement = Vector3.new()
            Movement = Movement + (RightVector * MoveDirection.X)
            Movement = Movement + (LookVector * MoveDirection.Z)
            Movement = Movement + (UpVector * MoveDirection.Y)
            
            -- Normalize and apply speed
            if Movement.Magnitude > 0 then
                Movement = Movement.Unit * CurrentSpeed * deltaTime
                -- Apply movement to the character
                HumanoidRootPart.CFrame = HumanoidRootPart.CFrame + Movement
            end
        end
    end)
    
    -- Cleanup function
    return function()
        if flightConnection then
            flightConnection:Disconnect()
        end
        if HumanoidRootPart and HumanoidRootPart.Parent then
            HumanoidRootPart.Anchored = WasAnchored
            HumanoidRootPart.Velocity = Vector3.new()
        end
        if Humanoid and Humanoid.Parent then
            Humanoid.PlatformStand = WasPlatformStand
            Humanoid.AutoRotate = true
        end
        -- Reset movement direction
        MoveDirection = Vector3.new()
    end
end

-- Keyboard input (for desktop)
UserInputService.InputBegan:Connect(function(input, processed)
    if processed or IS_MOBILE then return end
    
    if input.KeyCode == FlyKey then
        isEnabled = not isEnabled
        UpdateGUI()
        
        if isEnabled then
            local cleanup = FlyCharacter()
            task.spawn(function()
                while isEnabled do task.wait() end
                if cleanup then cleanup() end
            end)
        end
        return
    end
    
    if not isEnabled then return end
    
    local key = input.KeyCode
    if key == Enum.KeyCode.W then
        MoveDirection = Vector3.new(MoveDirection.X, MoveDirection.Y, -1)
    elseif key == Enum.KeyCode.S then
        MoveDirection = Vector3.new(MoveDirection.X, MoveDirection.Y, 1)
    elseif key == Enum.KeyCode.A then
        MoveDirection = Vector3.new(-1, MoveDirection.Y, MoveDirection.Z)
    elseif key == Enum.KeyCode.D then
        MoveDirection = Vector3.new(1, MoveDirection.Y, MoveDirection.Z)
    elseif key == Enum.KeyCode.Space then
        MoveDirection = Vector3.new(MoveDirection.X, 1, MoveDirection.Z)
    elseif key == Enum.KeyCode.LeftControl or key == Enum.KeyCode.RightControl then
        MoveDirection = Vector3.new(MoveDirection.X, -1, MoveDirection.Z)
    end
end)

UserInputService.InputEnded:Connect(function(input, processed)
    if processed or not isEnabled or IS_MOBILE then return end
    
    local key = input.KeyCode
    if key == Enum.KeyCode.W then
        MoveDirection = Vector3.new(MoveDirection.X, MoveDirection.Y, 0)
    elseif key == Enum.KeyCode.S then
        MoveDirection = Vector3.new(MoveDirection.X, MoveDirection.Y, 0)
    elseif key == Enum.KeyCode.A then
        MoveDirection = Vector3.new(0, MoveDirection.Y, MoveDirection.Z)
    elseif key == Enum.KeyCode.D then
        MoveDirection = Vector3.new(0, MoveDirection.Y, MoveDirection.Z)
    elseif key == Enum.KeyCode.Space then
        MoveDirection = Vector3.new(MoveDirection.X, 0, MoveDirection.Z)
    elseif key == Enum.KeyCode.LeftControl or key == Enum.KeyCode.RightControl then
        MoveDirection = Vector3.new(MoveDirection.X, 0, MoveDirection.Z)
    end
end)

UserInputService.InputChanged:Connect(function(input, processed)
    if processed or not isEnabled or IS_MOBILE or input.UserInputType ~= Enum.UserInputType.MouseWheel then
        return
    end
    
    CurrentSpeed = math.clamp(CurrentSpeed + (input.Position.Z * SpeedIncrement), 1, MaxSpeed)
    UpdateGUI()
end)

-- Handle character respawns
Player.CharacterAdded:Connect(function()
    if isEnabled then
        isEnabled = false
        UpdateGUI()
    end
end)

-- Initialize mobile GUI if needed
if IS_MOBILE then
    MobileGui.Enabled = true
end

UpdateGUI()
This is the complete, fixed script. The flight should now work properly with both keyboard and mobile controls. The key fix was in the FlyCharacter() function where it now continuously reads the MoveDirection variable and applies movement every frame.

now the mobile gui doesnt work
The issue is that the mobile GUI elements are being created but their Parent is set to MobileGui before MobileGui is parented to the player's GUI. This can cause issues. Let's fix the mobile GUI setup.

Replace the entire mobile GUI creation section (from -- Mobile Controls GUI to the end of the mobile button creations) with this corrected code:

lua
-- Mobile Controls GUI
local MobileGui = Instance.new("ScreenGui")
MobileGui.Name = "MobileFlightControls"
MobileGui.ResetOnSpawn = false
MobileGui.Enabled = false
MobileGui.Parent = Player.PlayerGui

-- Mobile Toggle Button
local ToggleButton = Instance.new("TextButton")
ToggleButton.Size = UDim2.new(0, 100, 0, 40)
ToggleButton.Position = UDim2.new(0.5, -50, 0.9, -40)
ToggleButton.AnchorPoint = Vector2.new(0.5, 0)
ToggleButton.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
ToggleButton.BackgroundTransparency = 0.5
ToggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
ToggleButton.Text = "Toggle Flight"
ToggleButton.Font = Enum.Font.GothamBold
ToggleButton.TextSize = 14

-- Mobile Joystick
local JoystickFrame = Instance.new("Frame")
JoystickFrame.Size = UDim2.new(0, 120, 0, 120)
JoystickFrame.Position = UDim2.new(0, 20, 0.7, -60)
JoystickFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
JoystickFrame.BackgroundTransparency = 0.7
JoystickFrame.BorderSizePixel = 0
JoystickFrame.Visible = false

local JoystickInner = Instance.new("Frame")
JoystickInner.Size = UDim2.new(0, 40, 0, 40)
JoystickInner.Position = UDim2.new(0.5, -20, 0.5, -20)
JoystickInner.AnchorPoint = Vector2.new(0.5, 0.5)
JoystickInner.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
JoystickInner.BackgroundTransparency = 0.5
JoystickInner.BorderSizePixel = 0
JoystickInner.Parent = JoystickFrame

-- Mobile Action Buttons
local UpButton = Instance.new("TextButton")
UpButton.Size = UDim2.new(0, 60, 0, 60)
UpButton.Position = UDim2.new(0.8, -30, 0.7, -90)
UpButton.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
UpButton.BackgroundTransparency = 0.5
UpButton.Text = "↑"
UpButton.TextColor3 = Color3.fromRGB(255, 255, 255)
UpButton.Font = Enum.Font.GothamBold
UpButton.TextSize = 20
UpButton.Visible = false

local DownButton = Instance.new("TextButton")
DownButton.Size = UDim2.new(0, 60, 0, 60)
DownButton.Position = UDim2.new(0.8, -30, 0.7, 0)
DownButton.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
DownButton.BackgroundTransparency = 0.5
DownButton.Text = "↓"
DownButton.TextColor3 = Color3.fromRGB(255, 255, 255)
DownButton.Font = Enum.Font.GothamBold
DownButton.TextSize = 20
DownButton.Visible = false

local SpeedUpButton = Instance.new("TextButton")
SpeedUpButton.Size = UDim2.new(0, 60, 0, 40)
SpeedUpButton.Position = UDim2.new(0.9, -60, 0.8, -80)
SpeedUpButton.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
SpeedUpButton.BackgroundTransparency = 0.5
SpeedUpButton.Text = "Speed+"
SpeedUpButton.TextColor3 = Color3.fromRGB(255, 255, 255)
SpeedUpButton.Font = Enum.Font.Gotham
SpeedUpButton.TextSize = 12
SpeedUpButton.Visible = false

local SpeedDownButton = Instance.new("TextButton")
SpeedDownButton.Size = UDim2.new(0, 60, 0, 40)
SpeedDownButton.Position = UDim2.new(0.9, -60, 0.8, -30)
SpeedDownButton.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
SpeedDownButton.BackgroundTransparency = 0.5
SpeedDownButton.Text = "Speed-"
SpeedDownButton.TextColor3 = Color3.fromRGB(255, 255, 255)
SpeedDownButton.Font = Enum.Font.Gotham
SpeedDownButton.TextSize = 12
SpeedDownButton.Visible = false

-- Parent all mobile elements AFTER they're fully configured
ToggleButton.Parent = MobileGui
JoystickFrame.Parent = MobileGui
UpButton.Parent = MobileGui
DownButton.Parent = MobileGui
SpeedUpButton.Parent = MobileGui
SpeedDownButton.Parent = MobileGui
